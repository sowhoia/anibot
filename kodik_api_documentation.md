# Документация по API Kodik: /list

## API-токен
**Ваш API-токен:** `1e2abef654f8af16891d0801d40ddaaa`

---

## Описание

Возвращает список всех материалов, подходящих под критерии запроса, либо вообще всех, если критерии не указаны.

Для удобства парсинга ответа, материалы возвращаются страницами. Каждая страница содержит ограниченное количество материалов, указанное в параметре `limit`. После парсинга первой страницы ваш скрипт должен переходить на следующую страницу, указанную в параметре `next` и так далее.

**Базовый URL:** `https://kodikapi.com/list`

---

## Параметры запроса

### Обязательные параметры

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `token` | Отсутствует | - | API-токен. Необходимо указать для успешного выполнения запроса |

### Необязательные параметры

#### Основные параметры

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `limit` | 50 | 1-100 | Количество материалов, выводимое за один раз |
| `sort` | `updated_at` | `year`, `created_at`, `updated_at`, `kinopoisk_rating`, `imdb_rating`, `shikimori_rating` | По какому полю сортировать материалы |
| `order` | `desc` | `asc` (по возрастанию), `desc` (по убыванию) | Направление сортировки |

#### Фильтрация по типу

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `types` | Все типы | **Фильмы:** `foreign-movie`, `soviet-cartoon`, `foreign-cartoon`, `russian-cartoon`, `anime`, `russian-movie`<br>**Сериалы:** `cartoon-serial`, `documentary-serial`, `russian-serial`, `foreign-serial`, `anime-serial`, `multi-part-film` | Фильтрация материалов по их типу. Необходимые типы указываются через запятую |

#### Фильтрация по году и озвучке

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `year` | Отсутствует | `1982`, `1982,2020` | Фильтрация материалов по году |
| `translation_id` | Отсутствует | `714`, `714,720` | Фильтрация материалов по ID озвучки. [Список озвучек](https://bd.kodik.biz/translations-list), [API озвучек](https://bd.kodik.biz/api/info/translations) |
| `block_translations` | Отсутствует | `714`, `714,720` | Удаление определенных озвучек из результатов поиска |
| `translation_type` | Отсутствует | `voice`, `subtitles` | Фильтрация по типу перевода (голосовой или субтитры) |

#### Фильтрация по качеству и контенту

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `has_field` | Отсутствует | `kinopoisk_id`, `imdb_id`, `mdl_id`, `worldart_link`, `shikimori_id` | Показываются материалы с хотя бы одним из указанных полей. Для всех полей используйте `has_field_and` |
| `camrip` | Отсутствует | `true`, `false` | Фильтрация по параметру camrip. `false` = только качественная картинка |
| `lgbt` | Отсутствует | `true`, `false` | Фильтрация по наличию LGBT сцен. `false` = материалы без LGBT сцен |

#### Параметры для сериалов

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `with_seasons` | `false` | `true`, `false` | Если `true`, вместе с сериалами в поле `seasons` будут перечислены сезоны |
| `with_episodes` | `false` | `true`, `false` | Если `true`, будет добавлено поле `seasons` и к каждому сезону будет добавлено поле `episodes` с ссылками серий |
| `with_episodes_data` | `false` | `true`, `false` | Аналогично `with_episodes`, но номерам серий соответствуют объекты с полями `link`, `title`, `screenshots` |
| `with_page_links` | `false` | `true`, `false` | Если `true`, ссылки на плееры будут заменены на ссылки на страницы с плеерами |

#### Блокировки по странам

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `not_blocked_in` | Отсутствует | `RU,UA`, `RU` | Фильтрация материалов по странам, в которых они НЕ заблокированы. Коды стран через запятую |
| `not_blocked_for_me` | Отсутствует | `true`, `false` | Сервер автоматически проверяет страну запроса и не выводит заблокированные материалы |

#### Информация с КиноПоиска, Shikimori, MyDramaList

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `with_material_data` | `false` | `true`, `false` | Если `true`, будет добавлено поле `material_data` с информацией с КП и Shikimori |
| `countries` | Отсутствует | `США`, `США,Россия` | Фильтрация по стране (хотя бы одна). Для всех стран используйте `countries_and` |
| `genres` | Отсутствует | `биография`, `биография,боевик` | Фильтрация по жанрам с КиноПоиск (хотя бы один). Для всех жанров: `genres_and` |
| `anime_genres` | Отсутствует | - | Фильтрация по жанрам Shikimori |
| `drama_genres` | Отсутствует | - | Фильтрация по жанрам MyDramaList |
| `all_genres` | Отсутствует | - | Фильтрация по всем жанрам |
| `duration` | Отсутствует | `30`, `40-80` | Фильтрация по продолжительности в минутах |
| `kinopoisk_rating` | Отсутствует | `7.0`, `6.5-8.2` | Фильтрация по рейтингу КиноПоиска |
| `imdb_rating` | Отсутствует | `7.0`, `6.5-8.2` | Фильтрация по рейтингу IMDb |
| `shikimori_rating` | Отсутствует | `7.0`, `6.5-8.2` | Фильтрация по рейтингу Shikimori |
| `mydramalist_rating` | Отсутствует | `7.0`, `6.5-8.2` | Фильтрация по рейтингу MyDramaList |

#### Персоны

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `actors` | Отсутствует | `Крис Хемсворт`, `Крис Хемсворт,Марк Руффало` | Фильтрация по актёрам (хотя бы один). Для всех: `actors_and` |
| `directors` | Отсутствует | - | Фильтрация по режиссёрам |
| `producers` | Отсутствует | - | Фильтрация по продюсерам |
| `writers` | Отсутствует | - | Фильтрация по сценаристам |
| `composers` | Отсутствует | - | Фильтрация по композиторам |
| `editors` | Отсутствует | - | Фильтрация по редакторам |
| `designers` | Отсутствует | - | Фильтрация по художникам |
| `operators` | Отсутствует | - | Фильтрация по операторам |

#### Дополнительные параметры

| Параметр | Стандартное значение | Доступные значения | Описание |
|----------|---------------------|-------------------|----------|
| `rating_mpaa` | Отсутствует | `G`, `PG`, `PG-13`, `R`, `R+`, `Rx` | Фильтрация по возрастному рейтингу MPAA |
| `minimal_age` | Отсутствует | `16`, `12-16` | Фильтрация по минимальному возрасту |
| `anime_kind` | Отсутствует | `tv`, `movie`, `ova`, `ona`, `special`, `music`, `tv_13`, `tv_24`, `tv_48` | Фильтрация по типу аниме |
| `mydramalist_tags` | Отсутствует | `Friendship`, `Friendship,Violence` | Фильтрация по тегам MyDramaList (хотя бы один). Для всех: `mydramalist_tags_and` |
| `anime_status` | Отсутствует | `anons`, `ongoing`, `released` | Фильтрация по статусу аниме на Shikimori |
| `drama_status` | Отсутствует | `anons`, `ongoing`, `released` | Фильтрация по статусу дорамы на MyDramaList |
| `all_status` | Отсутствует | `anons`, `ongoing`, `released` | Фильтрация по всем статусам |
| `anime_studios` | Отсутствует | `J.C.Staff`, `Studio Hibari` | Фильтрация по аниме-студии (хотя бы одна). Для всех: `anime_studios_and` |
| `anime_licensed_by` | Отсутствует | `Wakanim`, `Русский Репортаж` | Фильтрация по владельцу лицензии (хотя бы один). Для всех: `anime_licensed_by_and` |

---

## Структура ответа

### Поля в каждом материале

| Поле | Описание |
|------|----------|
| `id` | Уникальный ID материала |
| `title` | Название |
| `title_orig` | Оригинальное название |
| `other_title` | Другое название (часто в аниме) |
| `link` | Ссылка на плеер |
| `year` | Год |
| `kinopoisk_id` | ID КиноПоиска |
| `imdb_id` | ID IMDb |
| `mdl_id` | ID MyDramaList |
| `worldart_link` | Ссылка на World Art |
| `shikimori_id` | ID Shikimori (только цифры) |
| `type` | Тип материала |
| `quality` | Качество видео. [Список качеств](https://bd.kodik.biz/qualities-list), [API качества](https://bd.kodik.biz/api/info/qualities) |
| `camrip` | Является ли материал камрипом |
| `lgbt` | Содержит ли материал LGBT сцены |
| `translation` | Объект с `id`, `title` (название) и `type` (voice/subtitles) озвучки. [Список озвучек](https://bd.kodik.biz/translations-list) |
| `created_at` | Дата создания (ISO 8601) |
| `updated_at` | Дата обновления (ISO 8601) |
| `blocked_countries` | Массив стран, в которых заблокирован (или пустой массив) |
| `seasons` | Объект с сезонами и сериями (только если указаны `with_seasons` или `with_episodes`) |
| `last_season` | Номер последнего сезона (только для сериалов) |
| `last_episode` | Номер последней серии (только для сериалов) |
| `episodes_count` | Общее количество эпизодов (только для сериалов) |
| `blocked_seasons` | Информация о заблокированных сезонах/сериях (только для сериалов) |
| `screenshots` | Массив ссылок на кадры из видео |

### Формат поля `blocked_seasons` (для сериалов)

- Если весь сериал заблокирован: `"all"`
- Если заблокированы отдельные сезоны: объект вида:
  ```json
  {
    "5": "all",  // все серии сезона 5
    "7": ["1", "2", "3", "5"]  // отдельные серии сезона 7
  }
  ```
- Если ничего не заблокировано: пустой объект `{}`

### Формат поля `material_data` (при `with_material_data=true`)

```json
{
  "title": "Название",
  "title_en": "English Title",
  "year": 2011,
  "tagline": "Слоган",
  "description": "Описание...",
  "poster_url": "https://...",
  "duration": 55,
  "countries": ["США", "Великобритания"],
  "genres": ["фэнтези", "боевик", "драма"],
  "kinopoisk_rating": 9,
  "kinopoisk_votes": 268732,
  "imdb_rating": 9.4,
  "imdb_votes": 1553335,
  "premiere_ru": "2011-09-08"
}
```

---

## Примеры использования

### Пример 1: Базовый запрос

**Запрос:**
```
https://kodikapi.com/list?token=1e2abef654f8af16891d0801d40ddaaa
```

**Ответ:**
```json
{
  "time": "5ms",
  "total": 30590,
  "prev_page": null,
  "next_page": "https://kodikapi.com/list?token=...&next=...",
  "results": [
    {
      "id": "movie-452654",
      "type": "foreign-movie",
      "link": "http://kodik.cc/video/19850/6476310cc6d90aa9304d5d8af3a91279/720p",
      "title": "Спортлото-82",
      "title_orig": "Спортлото-82",
      "translation": {
        "id": 703,
        "title": "Не требуется",
        "type": "voice"
      },
      "year": 1982,
      "kinopoisk_id": "43949",
      "imdb_id": "tt0084716",
      "quality": "HDTVRip 720p",
      "blocked_countries": [],
      "created_at": "2017-12-03T09:12:49Z",
      "updated_at": "2018-04-10T08:25:23Z",
      "screenshots": [
        "https://i.kodik.biz/screenshots/video/50811/1.jpg",
        "https://i.kodik.biz/screenshots/video/50811/2.jpg",
        "https://i.kodik.biz/screenshots/video/50811/3.jpg",
        "https://i.kodik.biz/screenshots/video/50811/4.jpg",
        "https://i.kodik.biz/screenshots/video/50811/5.jpg"
      ]
    }
  ]
}
```

### Пример 2: Запрос с сериями и дополнительной информацией

**Запрос:**
```
https://kodikapi.com/list?token=1e2abef654f8af16891d0801d40ddaaa&types=anime-serial,foreign-serial&with_episodes=true&with_material_data=true
```

**Ответ:**
```json
{
  "time": "5ms",
  "total": 30590,
  "prev_page": null,
  "next_page": "https://kodikapi.com/list?token=...&next=...",
  "results": [
    {
      "id": "serial-452654",
      "type": "anime",
      "link": "http://kodik.cc/serial/4309/bc6def495a31545c7f648f7fb68d22a8/720p",
      "title": "Игра престолов",
      "title_orig": "Game of Thrones",
      "translation": {
        "id": 611,
        "title": "ColdFilm",
        "type": "voice"
      },
      "year": 2011,
      "last_season": 9,
      "last_episode": 4,
      "episodes_count": 119,
      "kinopoisk_id": "1161904",
      "imdb_id": "tt0944947",
      "quality": "WEB-DL 720p",
      "blocked_countries": ["RU"],
      "blocked_seasons": {
        "5": "all",
        "7": ["1", "2", "3", "5"]
      },
      "created_at": "2017-07-17T16:34:52Z",
      "updated_at": "2018-04-06T14:19:27Z",
      "seasons": {
        "5": {
          "link": "http://kodik.cc/season/27856/...",
          "episodes": {
            "1": "http://kodik.cc/seria/119601/...",
            "2": "http://kodik.cc/seria/203940/...",
            "3": "http://kodik.cc/seria/203941/..."
          }
        },
        "6": {
          "link": "http://kodik.cc/season/27857/...",
          "episodes": {
            "1": "http://kodik.cc/seria/119611/...",
            "2": "http://kodik.cc/seria/203949/..."
          }
        }
      },
      "material_data": {
        "title": "Игра престолов",
        "title_en": "Game of Thrones",
        "year": 2011,
        "tagline": "Победа или смерть",
        "description": "К концу подходит время благоденствия...",
        "poster_url": "https://st.kp.yandex.net/images/film_iphone/iphone360_464963.jpg",
        "duration": 55,
        "countries": ["США", "Великобритания"],
        "genres": ["фэнтези", "боевик", "драма"],
        "kinopoisk_rating": 9,
        "kinopoisk_votes": 268732,
        "imdb_rating": 9.4,
        "imdb_votes": 1553335,
        "premiere_ru": "2011-09-08"
      }
    }
  ]
}
```

---

## Важные замечания

1. **Пагинация**: Используйте параметр `next_page` из ответа для получения следующей страницы результатов
2. **Суффиксы `_and`**: Добавьте `_and` к параметрам фильтрации (например, `genres_and`, `countries_and`), чтобы требовать наличия ВСЕХ указанных значений вместо хотя бы одного
3. **Регистр**: Параметры фильтрации по персонам, жанрам и тегам регистронезависимы, но параметр `countries` регистрозависим
4. **Формат дат**: Все даты в формате ISO 8601 (например, `2017-12-03T09:12:49Z`)
5. **Ссылки**: Все ссылки начинаются с `http://` (не `https://`)

---

## Полезные ссылки

- [Список всех озвучек](https://bd.kodik.biz/translations-list)
- [API озвучек](https://bd.kodik.biz/api/info/translations)
- [Список всех качеств](https://bd.kodik.biz/qualities-list)
- [API качества](https://bd.kodik.biz/api/info/qualities)
